entier deplacements (tableau de 20 chaines de 38 caractères terrain, pointeur vers coordone coordPacMan, pointeur vers Coordone fantomeA, pointeur vers Coordone fantomeB, pointeur vers Coordone fantomeC, pointeur vers Coordone fantomeD)

VARIABLES charactère entree, pointA <-- '.', pointB <-- '.', pointC <-- '.', pointD <-- '.'
		  entiers score <-- 0, bonus <-- 0, frame <-- 0, c
		  entiers directionA <-- 0, directionB <-- 0, directionC <-- 0, directionD <-- 0

DEBUT

    //Le PacMan se déplace à l'aide des touches z,q,s et d. Le jeu peut être quitté avec Esc
	
    Faire

        Lire(entree) //En réalité le getch est remplacé par une API Windows afin de ne pas stopper le jeu à chaque frame

        CHOISIR entree parmi

            's':

                SI (terrain[coordPacMan.i + 1][coordPacMan.j]='.')

                    ALORS

                        terrain[coordPacMan.i][coordPacMan.j] <-- ' '
                        coordPacMan.i <-- coordPacMan.i + 1
                        terrain[coordPacMan.i][coordPacMan.j] <-- 'C'
                        score <-- score + 1

                    SINON SI (terrain[coordPacMan.i + 1][coordPacMan.j]=' ')

                        ALORS

                            terrain[coordPacMan.i][coordPacMan.j] <-- ' '
                            coordPacMan.i <-- coordPacMan.i + 1
                            terrain[coordPacMan.i][coordPacMan.j] <-- 'C'

                        SINON SI (terrain[coordPacMan.i + 1][coordPacMan.j]='M' ET non(bonus))
                            ALORS entree <-- 'Q'
								SINON SI(terrain[PacMan.i + 1][PacMan.j] = 'M' ET bonus) //Si c'est un fantôme et que le bonus est activé, PacMan mange le fantôme et gagne 10 points
									ALORS
									terrain[PacMan.i][PacMan.j] <-- ' ' //La réaparition de PacMan est gérée plus loin car il y a plusieurs fantômes et qu'il faut les gérer au cas par cas
									PacMan.i <-- PacMan.i + 1
									score <-- score + 10
									SINON SI(terrain[PacMan.i + 1][PacMan.j] = point) //Si la case est un bonus on active le bonus
										ALORS
										terrain[PacMan.i][PacMan.j] <-- ' '
										PacMan.i <-- PacMan.i + 1
										terrain[PacMan.i][PacMan.j] <-- 'C'
										bonus <-- 1
										SINON RIEN
									FIN SI
								FIN SI
						FIN SI
					FIN SI
				FIN SI
            'q':

                SI (terrain[coordPacMan.i][coordPacMan.j - 1]='.')

                    ALORS

                        terrain[coordPacMan.i][coordPacMan.j] <-- ' '
                        coordPacMan.j <-- coordPacMan.j - 1
                        terrain[coordPacMan.i][coordPacMan.j] <-- 'C'
                        score <-- score + 1

                    SINON SI (terrain[coordPacMan.i][coordPacMan.j - 1]=' ')

                        ALORS

                            terrain[coordPacMan.i][coordPacMan.j] <-- ' '
                            coordPacMan.j <-- coordPacMan.j - 1
                            terrain[coordPacMan.i][coordPacMan.j] <-- 'C'

                        SINON SI (terrain[coordPacMan.i][coordPacMan.j- 1]='M' ET non(bonus))
                            ALORS entree <-- 'Q'
								SINON SI(terrain[PacMan.i][PacMan.j - 1] = 'M' ET bonus) //Si c'est un fantôme et que le bonus est activé, PacMan mange le fantôme et gagne 10 points
									ALORS
									terrain[PacMan.i][PacMan.j] <-- ' ' //La réaparition de PacMan est gérée plus loin car il y a plusieurs fantômes et qu'il faut les gérer au cas par cas
									PacMan.j <-- PacMan.j - 1
									score <-- score + 10
									SINON SI(terrain[PacMan.i][PacMan.j - 1] = point) //Si la case est un bonus on active le bonus
										ALORS
										terrain[PacMan.i][PacMan.j] <-- ' '
										PacMan.j <-- PacMan.j - 1
										terrain[PacMan.i][PacMan.j] <-- 'C'
										bonus <-- 1
										SINON RIEN
									FIN SI
								FIN SI
						FIN SI

            'z':

                SI (terrain[coordPacMan.i - 1][coordPacMan.j]='.')

                    ALORS

                        terrain[coordPacMan.i][coordPacMan.j] <-- ' '
                        coordPacMan.i <-- coordPacMan.i - 1
                        terrain[coordPacMan.i][coordPacMan.j] <-- 'C'
                        score <-- score + 1

                    SINON SI (terrain[coordPacMan.i - 1][coordPacMan.j]=' ')

                        ALORS

                            terrain[coordPacMan.i][coordPacMan.j] <-- ' '
                            coordPacMan.i <-- coordPacMan.i - 1
                            terrain[coordPacMan.i][coordPacMan.j] <-- 'C'

                        SINON SI (terrain[coordPacMan.i - 1][coordPacMan.j]='M' ET non(bonus))
                            ALORS entree <-- 'Q'
								SINON SI(terrain[PacMan.i - 1][PacMan.j] = 'M' ET bonus) //Si c'est un fantôme et que le bonus est activé, PacMan mange le fantôme et gagne 10 points
									ALORS
									terrain[PacMan.i][PacMan.j] <-- ' ' //La réaparition de PacMan est gérée plus loin car il y a plusieurs fantômes et qu'il faut les gérer au cas par cas
									PacMan.i <-- PacMan.i - 1
									score <-- score + 10
									SINON SI(terrain[PacMan.i - 1][PacMan.j] = point) //Si la case est un bonus on active le bonus
										ALORS
										terrain[PacMan.i][PacMan.j] <-- ' '
										PacMan.i <-- PacMan.i - 1
										terrain[PacMan.i][PacMan.j] <-- 'C'
										bonus <-- 1
										SINON RIEN
									FIN SI
								FIN SI
						FIN SI
            'd':

                SI (terrain[coordPacMan.i][coordPacMan.j + 1]='.')

                    ALORS

                        terrain[coordPacMan.i][coordPacMan.j] <-- ' '
                        coordPacMan.j <-- coordPacMan.j + 1
                        terrain[coordPacMan.i][coordPacMan.j] <-- 'C'
                        score <-- score + 1

                    SINON SI (terrain[coordPacMan.i][coordPacMan.j + 1]=' ')

                        ALORS

                            terrain[coordPacMan.i][coordPacMan.j] <-- ' '
                            coordPacMan.j <-- coordPacMan.j + 1
                            terrain[coordPacMan.i][coordPacMan.j] <-- 'C'

                        SINON SI (terrain[coordPacMan.i][coordPacMan.j + 1]='M' ET non(bonus))
                            ALORS entree <-- 'Q'
								SINON SI(terrain[PacMan.i][PacMan.j + 1] = 'M' ET bonus) //Si c'est un fantôme et que le bonus est activé, PacMan mange le fantôme et gagne 10 points
									ALORS
									terrain[PacMan.i][PacMan.j] <-- ' ' //La réaparition de PacMan est gérée plus loin car il y a plusieurs fantômes et qu'il faut les gérer au cas par cas
									PacMan.j <-- PacMan.j + 1
									score <-- score + 10
									SINON SI(terrain[PacMan.i][PacMan.j + 1] = point) //Si la case est un bonus on active le bonus
										ALORS
										terrain[PacMan.i][PacMan.j] <-- ' '
										PacMan.j <-- PacMan.j + 1
										terrain[PacMan.i][PacMan.j] <-- 'C'
										bonus <-- 1
										SINON RIEN
									FIN SI
								FIN SI
						FIN SI
        SINON Rien
		
		
		SI(PacMan.i = fantomeA.i && PacMan.j = fantomeA.j)
        ALORS
            terrain[fantomeA.i][fantomeA.j] <-- 'C'
            fantomeA.i <-- 13
            fantomeA.j <-- 15
            pointA <-- ' '
            terrain[fantomeA.i][fantomeA.j] <-- 'M'
        FIN SI
        SINON SI(PacMan.i = fantomeB.i && PacMan.j = fantomeB.j)
        ALORS
            terrain[fantomeB.i][fantomeB.j] <-- 'C'
            fantomeB.i <-- 13
            fantomeB.j <-- 17
            pointB <-- ' '
            terrain[fantomeB.i][fantomeB.j] <-- 'M'
        FIN SI
        SINON SI(PacMan.i = fantomeC.i && PacMan.j = fantomeC.j)
        ALORS
            terrain[fantomeC.i][fantomeC.j] <-- 'C'
            fantomeC.i <-- 13
            fantomeC.j <-- 19
            pointC <-- ' '
            terrain[fantomeC.i][fantomeC.j] <-- 'M'
        FIN SI
        SINON SI(PacMan.i = fantomeD.i && PacMan.j = fantomeD.j)
        ALORS
            terrain[fantomeD.i][fantomeD.j] <-- 'C'
            fantomeD.i <-- 13
            fantomeD.j <-- 21
            pointD <-- ' '
            terrain[fantomeD.i][fantomeD.j] <-- 'M'
        FIN SI

		//Deplacement des fantomes
        directionA <-- ia(*PacMan, *fantomeA, terrain, directionA);
        directionB <-- ia(*PacMan, *fantomeB, terrain, directionB);
        directionC <-- ia(*PacMan, *fantomeC, terrain, directionC);
        directionD <-- ia(*PacMan, *fantomeD, terrain, directionD);


        //Deplacement des fantomes

        pointA <-- deplacementFantome(directionA, fantomeA, pointA, terrain, &entree, bonus)
        pointB <-- deplacementFantome(directionB, fantomeB, pointB, terrain, &entree, bonus)
        pointC <-- deplacementFantome(directionC, fantomeC, pointC, terrain, &entree, bonus)
        pointD <-- deplacementFantome(directionD, fantomeD, pointD, terrain, &entree, bonus)
		
        //On affiche la nouvelle frame ainsi générée
        affichage(terrain, score, bonus, frame);

        //compteur de frame
        SI(bonus)
        ALORS
            frame <-- frame + 1
        FIN SI

        //On réinitialise le bonus après 50 frames
        SI(frame>50)
        ALORS
            bonus<--0
            frame<--0
        FIN SI



    Tant que entree =/= 'Q'
	
	
    //On vide le buffer clavier car la fonction GetKeyState garde toutes les entrées en mémoire et les ressorts au getch suivant


   FAIRE

        textcolor(12)
        ECRIRE(\n\n\n                              GAME OVER\n\n\n\n)
        textcolor(15)
        ECRIRE(Pour sauvegarder et afficher votre score appuyer sur la touche espace)
        c <-- getch()
        system("CLS)

    } while (c =/= ' ') //On valide par espace

    fscore(score)

	
FIN